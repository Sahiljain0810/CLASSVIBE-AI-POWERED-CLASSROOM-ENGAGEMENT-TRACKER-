import cv2
import numpy as np
from tensorflow.keras.models import load_model

emotion_labels = ['Angry','Disgust','Fear','Happy','Sad','Surprise','Neutral']
model = load_model("emotion_model.h5")

def detect_emotion(face):
    gray = cv2.cvtColor(face, cv2.COLOR_BGR2GRAY)
    resized = cv2.resize(gray, (48,48))
    normalized = resized / 255.0
    reshaped = np.reshape(normalized, (1,48,48,1))
    result = model.predict(reshaped, verbose=0)
    return emotion_labels[np.argmax(result)]
